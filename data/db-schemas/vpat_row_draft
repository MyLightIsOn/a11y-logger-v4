create table public.vpat_row_draft (
  id uuid not null default gen_random_uuid (),
  vpat_id uuid not null,
  wcag_criterion_id uuid not null,
  conformance public.conformance_value null,
  remarks text null,
  related_issue_ids uuid[] null,
  related_issue_urls text[] null,
  last_generated_at timestamp with time zone null,
  last_edited_by uuid null,
  updated_at timestamp with time zone not null default now(),
  constraint vpat_row_draft_pkey primary key (id),
  constraint vpat_row_draft_vpat_id_wcag_criterion_id_key unique (vpat_id, wcag_criterion_id),
  constraint vpat_row_draft_vpat_id_fkey foreign KEY (vpat_id) references vpat (id) on delete CASCADE,
  constraint vpat_row_draft_wcag_criterion_id_fkey foreign KEY (wcag_criterion_id) references wcag_criteria (id)
) TABLESPACE pg_default;

create index IF not exists vpat_row_draft_vpat_idx on public.vpat_row_draft using btree (vpat_id) TABLESPACE pg_default;

create index IF not exists vpat_row_draft_vpat_criterion_idx on public.vpat_row_draft using btree (vpat_id, wcag_criterion_id) TABLESPACE pg_default;

create index IF not exists vpat_row_draft_related_issue_ids_gin on public.vpat_row_draft using gin (related_issue_ids) TABLESPACE pg_default;

create trigger trg_set_updated_at_vpat_row_draft BEFORE
update on vpat_row_draft for EACH row
execute FUNCTION set_updated_at ();

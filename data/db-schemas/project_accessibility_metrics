create table public.project_accessibility_metrics (
  id uuid not null default gen_random_uuid (),
  project_id uuid not null,
  snapshot_at timestamp with time zone not null default now(),
  counts_by_severity jsonb null,
  counts_by_wcag_level jsonb null,
  open_vs_resolved jsonb null,
  notes jsonb null,
  constraint project_accessibility_metrics_pkey primary key (id),
  constraint project_accessibility_metrics_project_id_fkey foreign KEY (project_id) references projects (id) on delete CASCADE
) TABLESPACE pg_default;

create index IF not exists pam_project_time_idx on public.project_accessibility_metrics using btree (project_id, snapshot_at desc) TABLESPACE pg_default;
